import{d as T,r as G,a as S,b as a,o as L,c as B,w as l,e as r,f as t,g as s,h as m,n as _,p as q,i as A,j as h,_ as M}from"./index-01cbf18e.js";import{l as N}from"./medical-c6f0a0f6.js";import{A as R}from"./AnimatedBackground-5c67056e.js";const U=u=>(q("data-v-5505c141"),u=u(),A(),u),C={class:"is-login"},$=U(()=>r("h3",{class:"title"},"云链·医问",-1)),j={class:"form-group"},z={class:"check"},E=T({__name:"Login",setup(u){const o=G({name:"",password:"",userType:"1"}),x={name:[{required:!0,message:"请输入用户名称",trigger:"blur"}],password:[{required:!0,message:"请输入登录密码",trigger:"blur"},{min:6,max:12,message:"密码长度应在 6 到 12 个字符之间",trigger:"blur"}],userType:[{required:!0,message:"请选择用户类型",trigger:"change"}]},p=S(null),n=S(!1),f=()=>{if(!p.value){console.log("formRef is null");return}p.value.validate(g=>{g?(n.value=!0,N(o.name,parseInt(o.userType),o.password).then(e=>{if(console.log("登录响应:",e),e.code==200){if(!e.id||!e.address||!e.name){alert("登录响应数据不完整，请联系管理员"),n.value=!1;return}localStorage.setItem("userId",e.id),localStorage.setItem("accountAddress",e.address),localStorage.setItem("name",e.name),o.userType==="2"?(localStorage.setItem("userType","2"),h.push("/doctor")):(localStorage.setItem("userType","1"),h.push("/patient")),alert("登录成功!"),console.log(e.msg)}else alert(e.msg||"登录失败，请检查用户名和密码");n.value=!1}).catch(e=>{console.error("登录错误:",e),n.value=!1,alert(typeof e=="string"?"密码错误或用户名错误":"登录失败，请检查用户名和密码")})):console.log("表单验证失败")})},I=()=>{o.name="",o.password="",o.userType="1"};return(g,e)=>{const y=a("el-input"),c=a("el-form-item"),b=a("el-radio"),V=a("el-radio-group"),k=a("el-form"),w=a("el-button"),v=a("router-link");return L(),B(R,null,{default:l(({themeColors:d})=>[r("div",C,[$,t(k,{ref_key:"formRef",ref:p,model:o,rules:x,onSubmit:m(f,["prevent"]),style:{"max-width":"400px"},"label-width":"auto",class:"login-form"},{default:l(()=>[t(c,{label:"用户名称",prop:"name"},{default:l(()=>[t(y,{style:{width:"300px"},type:"text",class:"form-control",id:"name",placeholder:"请输入用户名称",autocomplete:"off",modelValue:o.name,"onUpdate:modelValue":e[0]||(e[0]=i=>o.name=i),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1}),t(c,{label:"登录密码",prop:"password"},{default:l(()=>[t(y,{style:{width:"300px"},type:"password",class:"form-control",id:"password",placeholder:"请输入登录密码",autocomplete:"off",modelValue:o.password,"onUpdate:modelValue":e[1]||(e[1]=i=>o.password=i),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1}),t(c,{label:"用户类型",prop:"userType"},{default:l(()=>[t(V,{modelValue:o.userType,"onUpdate:modelValue":e[2]||(e[2]=i=>o.userType=i)},{default:l(()=>[t(b,{label:"1"},{default:l(()=>[s("病人")]),_:1}),t(b,{label:"2"},{default:l(()=>[s("医生")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"]),r("div",j,[t(w,{type:"primary",class:"login-btn",onClick:m(f,["stop"]),loading:n.value,style:_({background:`linear-gradient(135deg, ${d.buttonGradientStart} 0%, ${d.buttonGradientEnd} 100%)`})},{default:l(()=>[s("登录")]),_:2},1032,["loading","style"]),t(w,{class:"reset-btn",onClick:m(I,["stop"]),style:_({borderColor:d.buttonGradientStart,color:d.buttonGradientStart})},{default:l(()=>[s("重置")]),_:2},1032,["style"])]),r("div",z,[r("p",null,[t(v,{style:_({color:d.buttonGradientStart}),to:"/register",class:"register-link"},{default:l(()=>[s("立即注册")]),_:2},1032,["style"])]),r("p",null,[t(v,{to:"/forgot-password",class:"forgot-password"},{default:l(()=>[s("忘记密码？")]),_:1})])])])]),_:1})}}});const J=M(E,[["__scopeId","data-v-5505c141"]]);export{J as default};
