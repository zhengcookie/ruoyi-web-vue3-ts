import{h as B,i as L}from"./medical-c6f0a0f6.js";import{d as O,a as c,r as P,q as $,b as n,o as j,k as q,e as w,f as a,w as d,g as m,y as C,p as E,i as A,_ as G}from"./index-01cbf18e.js";const J=_=>(E("data-v-c735c639"),_=_(),A(),_),K={class:"my-medical"},Q=J(()=>w("h2",{class:"page-title"},"我的病历",-1)),W={class:"search-section"},X={class:"pagination"},Y=O({__name:"MyMedical",setup(_){const f=c(""),b=c([]),p=c(!1),g=c("病历详情"),t=P({recordId:0,patientName:"",hospitalName:"",department:"",doctorName:"",pastMedicalHistory:"",currentMedicalHistory:"",createTime:"",isFilled:!1,registrationInfo:""}),i=c(!0),h=parseInt(localStorage.getItem("userId")||"0"),y=c(1),V=c(10),N=c(0),I=o=>{if(!o)return"";const e=new Date(o);return e.toLocaleString()!=="Invalid Date"?e.toLocaleString():""},v=async()=>{try{const o=await B(h);console.log("获取病历列表响应:",o),o&&(b.value=o.map(e=>({...e,createTime:I(e.createTime)})),N.value=o.length||0)}catch(o){console.error("获取病历失败",o)}},S=o=>{V.value=o,v()},T=o=>{y.value=o,v()},F=async()=>{if(!f.value){v();return}try{const o=parseInt(f.value);if(isNaN(o)){console.error("病历ID必须是数字");return}const e=await L(o,h);console.log("查询病历响应:",e),e.code===200?(H(),t.recordId=e.recordId,t.patientName=e.patientName||"未知",t.doctorName=e.doctorName||"未知",t.hospitalName=e.hospitalName||"",t.department=e.department||"",t.pastMedicalHistory=e.pastMedicalHistory||"",t.currentMedicalHistory=e.currentMedicalHistory||"",t.registrationInfo=e.registrationInfo||"",t.createTime=I(e.createTime),t.isFilled=e.isFilled||!1,b.value=[{recordId:e.recordId,patientName:e.patientName||"未知",doctorName:e.doctorName||"未知",hospitalName:e.hospitalName||"",department:e.department||"",pastMedicalHistory:e.pastMedicalHistory||"",currentMedicalHistory:e.currentMedicalHistory||"",registrationInfo:e.registrationInfo||"",createTime:I(e.createTime),isFilled:e.isFilled||!1}],N.value=1,i.value=e.isFilled||!0,g.value="病历详情",p.value=!0):console.error("未找到病历信息")}catch(o){console.error("搜索失败",o)}},H=()=>{t.recordId=0,t.patientName="",t.hospitalName="",t.department="",t.doctorName="",t.pastMedicalHistory="",t.currentMedicalHistory="",t.createTime="",t.isFilled=!1,t.registrationInfo=""},U=o=>{H(),Object.assign(t,o),i.value=o.isFilled,g.value="病历详情",p.value=!0};return $(()=>{v()}),(o,e)=>{const r=n("el-input"),M=n("el-button"),u=n("el-table-column"),x=n("el-tag"),z=n("el-table"),k=n("el-pagination"),s=n("el-descriptions-item"),D=n("el-descriptions"),R=n("el-dialog");return j(),q("div",K,[Q,w("div",W,[a(r,{modelValue:f.value,"onUpdate:modelValue":e[0]||(e[0]=l=>f.value=l),placeholder:"请输入病历ID"},null,8,["modelValue"]),a(M,{type:"primary",onClick:F,class:"search-btn"},{default:d(()=>[m("搜索病历")]),_:1})]),a(z,{data:b.value,border:"",style:{width:"100%"}},{default:d(()=>[a(u,{prop:"recordId",label:"病历ID",width:"120"}),a(u,{prop:"patientName",label:"患者姓名",width:"120"}),a(u,{prop:"hospitalName",label:"医院名称",width:"180"}),a(u,{prop:"department",label:"科室",width:"120"}),a(u,{prop:"doctorName",label:"医生姓名",width:"120"}),a(u,{prop:"isFilled",label:"状态",width:"100"},{default:d(l=>[a(x,{type:l.row.isFilled?"success":"info"},{default:d(()=>[m(C(l.row.isFilled?"已完成":"未完成"),1)]),_:2},1032,["type"])]),_:1}),a(u,{prop:"createTime",label:"创建时间",width:"180"}),a(u,{label:"操作",width:"180"},{default:d(l=>[a(M,{type:"primary",size:"small",onClick:Z=>U(l.row)},{default:d(()=>[m("查看")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),w("div",X,[a(k,{"current-page":y.value,"onUpdate:currentPage":e[1]||(e[1]=l=>y.value=l),"page-size":V.value,"onUpdate:pageSize":e[2]||(e[2]=l=>V.value=l),"page-sizes":[10,20,30,50],total:N.value,layout:"total, sizes, prev, pager, next",onSizeChange:S,onCurrentChange:T},null,8,["current-page","page-size","total"])]),a(R,{modelValue:p.value,"onUpdate:modelValue":e[12]||(e[12]=l=>p.value=l),title:g.value,width:"60%"},{footer:d(()=>[a(M,{onClick:e[11]||(e[11]=l=>p.value=!1)},{default:d(()=>[m("关闭")]),_:1})]),default:d(()=>[a(D,{column:2,border:""},{default:d(()=>[a(s,{label:"病历编号"},{default:d(()=>[a(r,{modelValue:t.recordId,"onUpdate:modelValue":e[3]||(e[3]=l=>t.recordId=l),disabled:i.value},null,8,["modelValue","disabled"])]),_:1}),a(s,{label:"患者姓名"},{default:d(()=>[a(r,{modelValue:t.patientName,"onUpdate:modelValue":e[4]||(e[4]=l=>t.patientName=l),disabled:i.value},null,8,["modelValue","disabled"])]),_:1}),a(s,{label:"医院名称"},{default:d(()=>[a(r,{modelValue:t.hospitalName,"onUpdate:modelValue":e[5]||(e[5]=l=>t.hospitalName=l),disabled:i.value},null,8,["modelValue","disabled"])]),_:1}),a(s,{label:"科室"},{default:d(()=>[a(r,{modelValue:t.department,"onUpdate:modelValue":e[6]||(e[6]=l=>t.department=l),disabled:i.value},null,8,["modelValue","disabled"])]),_:1}),a(s,{label:"医生姓名"},{default:d(()=>[a(r,{modelValue:t.doctorName,"onUpdate:modelValue":e[7]||(e[7]=l=>t.doctorName=l),disabled:i.value},null,8,["modelValue","disabled"])]),_:1}),a(s,{label:"挂号信息"},{default:d(()=>[a(r,{modelValue:t.registrationInfo,"onUpdate:modelValue":e[8]||(e[8]=l=>t.registrationInfo=l),type:"textarea",rows:2,disabled:i.value},null,8,["modelValue","disabled"])]),_:1}),a(s,{label:"既往病史"},{default:d(()=>[a(r,{modelValue:t.pastMedicalHistory,"onUpdate:modelValue":e[9]||(e[9]=l=>t.pastMedicalHistory=l),type:"textarea",rows:3,disabled:i.value},null,8,["modelValue","disabled"])]),_:1}),a(s,{label:"现病史"},{default:d(()=>[a(r,{modelValue:t.currentMedicalHistory,"onUpdate:modelValue":e[10]||(e[10]=l=>t.currentMedicalHistory=l),type:"textarea",rows:3,disabled:i.value},null,8,["modelValue","disabled"])]),_:1}),a(s,{label:"状态"},{default:d(()=>[m(C(t.isFilled?"已完成":"未完成"),1)]),_:1})]),_:1})]),_:1},8,["modelValue","title"])])}}});const ae=G(Y,[["__scopeId","data-v-c735c639"]]);export{ae as default};
