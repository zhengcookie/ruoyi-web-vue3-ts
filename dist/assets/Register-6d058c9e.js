import{d as q,a as c,r as E,b as n,o as C,c as z,w as a,e as u,f as l,k as G,l as A,g as d,h as N,n as y,E as P,j,p as D,i as L,_ as F}from"./index-01cbf18e.js";import{s as H,r as J}from"./medical-c6f0a0f6.js";import{A as K}from"./AnimatedBackground-5c67056e.js";const O=p=>(D("data-v-ba9d8067"),p=p(),L(),p),Q={class:"is-register"},W=O(()=>u("h3",{class:"title"},"云链·医问",-1)),X={class:"verification-code-container"},Y={key:0,class:"verification-image-container"},Z=["src"],ee={class:"form-group"},te={class:"login-link"},oe=q({__name:"Register",setup(p){const _=c(null),h=c(1),f=c(!1),k={name:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:1,max:10,message:"用户名长度应在3到10个字符之间",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:12,message:"密码长度应在6到12个字符之间",trigger:"blur"}],age:[{required:!0,message:"请输入年龄",trigger:"blur"}],userType:[{required:!0,message:"请选择用户类型",trigger:"change"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:"blur"}],inputCode:[{required:!0,message:"请输入验证码",trigger:"blur"}]},e=E({password:"",gender:"男",age:0,name:"",userType:1,email:"",code:"",inputCode:""}),v=c(!1),b=c(""),S=s=>{const t=document.createElement("canvas"),o=t.getContext("2d");if(t.width=120,t.height=40,o){o.fillStyle="#f0f2f5",o.fillRect(0,0,t.width,t.height);for(let r=0;r<3;r++)o.strokeStyle=`rgb(${Math.floor(Math.random()*200)}, ${Math.floor(Math.random()*200)}, ${Math.floor(Math.random()*200)})`,o.beginPath(),o.moveTo(Math.random()*t.width,Math.random()*t.height),o.lineTo(Math.random()*t.width,Math.random()*t.height),o.stroke();for(let r=0;r<30;r++)o.fillStyle=`rgb(${Math.floor(Math.random()*200)}, ${Math.floor(Math.random()*200)}, ${Math.floor(Math.random()*200)})`,o.beginPath(),o.arc(Math.random()*t.width,Math.random()*t.height,1,0,2*Math.PI),o.fill();return o.fillStyle="#4a9e5c",o.font="bold 24px Arial",o.textAlign="center",o.textBaseline="middle",o.fillText(s,t.width/2,t.height/2),t.toDataURL("image/png")}return""},T=()=>{e.email&&/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.email)&&V()},V=()=>{if(!e.email){P.warning("请先输入邮箱");return}v.value=!0,H(e.email).then(s=>{s.code==200&&(console.log(s.msg),e.code=s.verificationCode,b.value=S(e.code)),v.value=!1}).catch(s=>{console.log(s),v.value=!1})},R=()=>{V()},w=()=>{if(h.value==1?e.gender="男":e.gender="女",!_.value){console.log("formRef is null");return}_.value.validate(s=>{if(s){if(e.inputCode!==e.code){alert("验证码错误，请重新输入");return}f.value=!0,J(e.name,e.gender,e.age,e.password,e.userType,e.email).then(t=>{setTimeout(()=>{t.code==200?(alert("注册成功!"),j.push("/login")):alert(t.msg),f.value=!1},1e3)}).catch(t=>{console.log(t),f.value=!1})}})},U=()=>{e.name="",e.gender="男",e.age=0,e.password="",e.userType=1,e.email="",e.inputCode="",e.code=""};return(s,t)=>{const o=n("el-input"),r=n("el-form-item"),$=n("el-input-number"),g=n("el-radio"),M=n("el-radio-group"),B=n("el-form"),x=n("el-button"),I=n("router-link");return C(),z(K,null,{default:a(({themeColors:m})=>[u("div",Q,[W,l(B,{ref_key:"formRef",ref:_,model:e,rules:k,onSubmit:N(w,["prevent"]),style:{"max-width":"400px"},"label-width":"auto",class:"register-form"},{default:a(()=>[l(r,{label:"邮箱",prop:"email"},{default:a(()=>[l(o,{style:{width:"300px"},type:"email",class:"form-control",id:"email",placeholder:"请输入邮箱",autocomplete:"off",modelValue:e.email,"onUpdate:modelValue":t[0]||(t[0]=i=>e.email=i),modelModifiers:{trim:!0},onBlur:T},null,8,["modelValue"])]),_:1}),l(r,{label:"验证码",prop:"inputCode"},{default:a(()=>[u("div",X,[l(o,{style:{width:"200px"},type:"text",class:"form-control",id:"verification-code",placeholder:"请输入验证码",autocomplete:"off",modelValue:e.inputCode,"onUpdate:modelValue":t[1]||(t[1]=i=>e.inputCode=i),modelModifiers:{trim:!0}},null,8,["modelValue"])]),b.value?(C(),G("div",Y,[u("img",{src:b.value,alt:"验证码",class:"verification-image",onClick:R,title:"点击刷新验证码"},null,8,Z)])):A("",!0)]),_:1}),l(r,{label:"注册名称",prop:"name"},{default:a(()=>[l(o,{style:{width:"300px"},type:"text",class:"form-control",id:"name",placeholder:"请输入注册名称",autocomplete:"off",modelValue:e.name,"onUpdate:modelValue":t[2]||(t[2]=i=>e.name=i),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1}),l(r,{label:"注册密码",prop:"password"},{default:a(()=>[l(o,{style:{width:"300px"},type:"password",class:"form-control",id:"password",placeholder:"请输入注册密码",autocomplete:"off",modelValue:e.password,"onUpdate:modelValue":t[3]||(t[3]=i=>e.password=i),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1}),l(r,{label:"年龄",prop:"age"},{default:a(()=>[l($,{modelValue:e.age,"onUpdate:modelValue":t[4]||(t[4]=i=>e.age=i),min:1,max:100},null,8,["modelValue"])]),_:1}),l(r,{label:"性别",prop:"gender"},{default:a(()=>[l(M,{modelValue:h.value,"onUpdate:modelValue":t[5]||(t[5]=i=>h.value=i)},{default:a(()=>[l(g,{value:1,size:"small"},{default:a(()=>[d("男")]),_:1}),l(g,{value:2,size:"small"},{default:a(()=>[d("女")]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(r,{label:"用户类型",prop:"userType"},{default:a(()=>[l(M,{modelValue:e.userType,"onUpdate:modelValue":t[6]||(t[6]=i=>e.userType=i)},{default:a(()=>[l(g,{value:1,size:"small"},{default:a(()=>[d("患者")]),_:1}),l(g,{value:2,size:"small"},{default:a(()=>[d("医生")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"]),u("div",ee,[l(x,{type:"primary",class:"register-btn",onClick:w,loading:f.value,style:y({background:`linear-gradient(135deg, ${m.buttonGradientStart} 0%, ${m.buttonGradientEnd} 100%)`})},{default:a(()=>[d("注册")]),_:2},1032,["loading","style"]),l(x,{class:"reset-btn",onClick:U,style:y({borderColor:m.buttonGradientStart,color:m.buttonGradientStart})},{default:a(()=>[d("重置")]),_:2},1032,["style"])]),u("div",te,[u("p",null,[d("已有账号？"),l(I,{style:y({color:m.buttonGradientStart}),to:"/login"},{default:a(()=>[d("点击登录")]),_:2},1032,["style"])])])])]),_:1})}}});const ie=F(oe,[["__scopeId","data-v-ba9d8067"]]);export{ie as default};
